---
import SectionTitle from "@/components/SectionTitle.astro";
import type { GalleryData } from "@/config/landing.interface";

interface Props {
  data: GalleryData;
}

const { data } = Astro.props;
---

<section id="gallery-section" class="gallery-section flex flex-col mb-60 gap-y-28">
  <div class={data.layout === "full-width" ? "w-full" : "max-w-7xl mx-auto w-full"}>
    <SectionTitle>
      {data.title}
    </SectionTitle>

    {data.description && (
      <p class="gallery-description text-center text-lg text-gray-600 max-w-3xl mx-auto -mt-16 mb-16">
        {data.description}
      </p>
    )}

    {/* Grid Layout */}
    {data.layout === "grid" && (
      <div class={`grid gap-6 ${
        data.columns === 2
          ? "md:grid-cols-2"
          : data.columns === 3
          ? "md:grid-cols-2 lg:grid-cols-3"
          : data.columns === 4
          ? "md:grid-cols-2 lg:grid-cols-4"
          : "md:grid-cols-2 lg:grid-cols-3"
      }`}>
        {
          data.images.map((image) => (
            <div class="gallery-item group relative overflow-hidden rounded-xl shadow-lg hover:shadow-2xl transition-all">
              <img
                src={image.src}
                alt={image.alt || image.title || "Gallery image"}
                class="w-full h-64 object-cover group-hover:scale-110 transition-transform duration-300"
                loading="lazy"
              />
              {(image.title || image.description) && (
                <div class="gallery-overlay absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-6">
                  {image.title && (
                    <h3 class="text-white text-xl font-bold mb-2">{image.title}</h3>
                  )}
                  {image.description && (
                    <p class="text-white/90 text-sm">{image.description}</p>
                  )}
                </div>
              )}
            </div>
          ))
        }
      </div>
    )}

    {/* Masonry Layout */}
    {data.layout === "masonry" && (
      <div class="columns-1 md:columns-2 lg:columns-3 gap-6 space-y-6">
        {
          data.images.map((image) => (
            <div class="gallery-item group relative overflow-hidden rounded-xl shadow-lg hover:shadow-2xl transition-all break-inside-avoid">
              <img
                src={image.src}
                alt={image.alt || image.title || "Gallery image"}
                class="w-full h-auto object-cover group-hover:scale-105 transition-transform duration-300"
                loading="lazy"
              />
              {(image.title || image.description) && (
                <div class="gallery-overlay absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-6">
                  {image.title && (
                    <h3 class="text-white text-xl font-bold mb-2">{image.title}</h3>
                  )}
                  {image.description && (
                    <p class="text-white/90 text-sm">{image.description}</p>
                  )}
                </div>
              )}
            </div>
          ))
        }
      </div>
    )}

    {/* Carousel Layout */}
    {data.layout === "carousel" && (
      <div class="relative overflow-hidden">
        <div class="gallery-carousel flex gap-6 overflow-x-auto snap-x snap-mandatory pb-6 scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200">
          {
            data.images.map((image) => (
              <div class="gallery-item group relative flex-shrink-0 w-full md:w-1/2 lg:w-1/3 snap-center overflow-hidden rounded-xl shadow-lg hover:shadow-2xl transition-all">
                <img
                  src={image.src}
                  alt={image.alt || image.title || "Gallery image"}
                  class="w-full h-80 object-cover group-hover:scale-110 transition-transform duration-300"
                  loading="lazy"
                />
                {(image.title || image.description) && (
                  <div class="gallery-overlay absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-6">
                    {image.title && (
                      <h3 class="text-white text-xl font-bold mb-2">{image.title}</h3>
                    )}
                    {image.description && (
                      <p class="text-white/90 text-sm">{image.description}</p>
                    )}
                  </div>
                )}
              </div>
            ))
          }
        </div>
      </div>
    )}

    {/* Full Width Layout */}
    {data.layout === "full-width" && (
      <div class="space-y-12">
        {
          data.images.map((image, index) => (
            <div class={`gallery-item group relative overflow-hidden ${index % 2 === 0 ? "" : "ml-auto max-w-5xl"}`}>
              <img
                src={image.src}
                alt={image.alt || image.title || "Gallery image"}
                class="w-full h-auto object-cover rounded-2xl shadow-2xl group-hover:shadow-3xl transition-shadow duration-300"
                loading="lazy"
              />
              {(image.title || image.description) && (
                <div class="mt-6 text-center">
                  {image.title && (
                    <h3 class="text-2xl font-bold text-gray-900 mb-2">{image.title}</h3>
                  )}
                  {image.description && (
                    <p class="text-gray-600 max-w-2xl mx-auto">{image.description}</p>
                  )}
                </div>
              )}
            </div>
          ))
        }
      </div>
    )}

    {data.loadMoreText && (
      <div class="flex justify-center mt-12">
        <button
          class="load-more-btn bg-primary text-white hover:bg-blue-700 px-8 py-4 text-lg font-semibold rounded-lg transition-colors"
        >
          {data.loadMoreText}
        </button>
      </div>
    )}
  </div>
</section>

<style>
  .gallery-section {
    color: var(--theme-text, inherit);
  }

  .gallery-description {
    color: var(--theme-text-secondary, inherit);
  }

  .gallery-item {
    background-color: var(--theme-card-bg, #FFFFFF);
  }

  .load-more-btn {
    background-color: var(--theme-accent, #1D4ED8);
  }

  .load-more-btn:hover {
    opacity: 0.9;
  }

  /* Smooth scrolling for carousel */
  .gallery-carousel {
    scroll-behavior: smooth;
  }

  /* Hide scrollbar for carousel on smaller screens */
  @media (max-width: 768px) {
    .gallery-carousel::-webkit-scrollbar {
      display: none;
    }

    .gallery-carousel {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  }
</style>
